<div class="metadata-tree-item" ng-form="itemForm">
  <div class="input-group input-group-sm"
       ng-switch on="item.leaf.type"
       ng-if="item.leaf.type !== 'array'"
       ng-class="{'has-error': itemForm.property.$invalid && itemForm.property.$dirty}">
    <span class="input-group-addon"
          title="{$ ::item.leaf.name $}"
          ng-bind="::item.leaf.name">
    </span>
    <input ng-switch-when="string"
           ng-if="!item.leaf.enum"
           name="property"
           type="text"
           class="form-control"
           pattern="{$ ::item.leaf.pattern $}"
           required
           ng-model="item.leaf.value"
           ng-minlength="{$ ::item.leaf.minLength $}"
           ng-maxlength="{$ ::item.leaf.maxLength $}"
           ng-disabled="item.leaf.readonly"/>
    <select ng-switch-when="string"
            ng-if="item.leaf.enum"
            name="property"
            class="form-control"
            required
            ng-model="item.leaf.value"
            ng-options="op for op in item.leaf.enum"
            ng-disabled="item.leaf.readonly">
    </select>
    <input ng-switch-when="integer"
           name="property"
           type="number"
           class="form-control"
           required
           ng-model="item.leaf.value"
           ng-pattern="/^-?\d+$/"
           min="{$ ::item.leaf.minimum $}"
           max="{$ ::item.leaf.maximum $}"
           step="1"
           ng-disabled="item.leaf.readonly"/>
    <input ng-switch-when="number"
           name="property"
           type="number"
           class="form-control"
           required
           ng-model="item.leaf.value"
           min="{$ ::item.leaf.minimum $}"
           max="{$ ::item.leaf.maximum $}"
           ng-disabled="item.leaf.readonly"/>
    <div class="input-group-addon bool"
         ng-switch-when="boolean">
      <input name="property"
             type="checkbox"
             ng-model="item.leaf.value"
             ng-disabled="item.leaf.readonly"/>
    </div>
    <div class="input-group-btn">
      <a class="btn btn-default"
         ng-click="action()">
        <span class="fa fa-minus"></span>
      </a>
    </div>
  </div>
  <div ng-if="item.leaf.type === 'array'"
       class="panel panel-default multiselect">
    <div class="panel-heading">
      <div ng-click="open()">
        <span class="fa fa-fw"
              ng-class="item.leaf.readonly ? '' : opened ? 'fa-chevron-down' : 'fa-chevron-right'">
        </span>
        <span ng-bind="::item.leaf.name"></span>
        <div class="text-right">
          <a class="btn btn-xs btn-default" ng-click="action()">
            <i class="fa fa-minus"></i>
          </a>
        </div>
      </div>
    </div>
    <div class="panel-body values"
         ng-class="{disabled: item.leaf.readonly}">
      <span ng-repeat="val in item.leaf.value">
        <span class="label label-default"
              ng-click="remove(val)">
          <span ng-bind="::val"></span>
          <span class="fa fa-times" ng-if="!item.leaf.readonly"></span>
        </span>
      </span>
    </div>
    <ul class="list-group options" ng-show="opened">
      <li class="list-group-item"
          ng-repeat="val in values"
          ng-click="add(val)">
        <span ng-bind="::val"></span>
      </li>
    </ul>
    <div class="panel-footer" ng-show="opened">
      <div class="form-inline clearfix">
        <div class="form-group pull-right">
          <label>Operator</label>
          <select class="form-control input-sm"
                  ng-model="item.leaf.operator"
                  ng-options="val for val in item.leaf.operators">
          </select>
        </div>
      </div>
    </div>
  </div>
  <div class="label label-info">
    <span ng-bind="::item.breadcrumb()"></span>
  </div>
  <div class="label label-danger"
       ng-if="itemForm.$invalid && itemForm.$dirty">
    <span ng-bind="formatErrorMessage(item, itemForm.property.$error)"></span>
  </div>
</div>